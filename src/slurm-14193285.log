/scratch/nsk367/anaconda3/envs/irl/lib/python3.8/site-packages/torch/tensor.py:447: UserWarning: non-inplace resize is deprecated
  warnings.warn("non-inplace resize is deprecated")
0:: 4096 episode score is 0.65
0:: 4096 episode similarity score is 0.15
Traceback (most recent call last):
  File "main.py", line 245, in <module>
    main()
  File "main.py", line 203, in main
    expert_acc, learner_acc = train_discrim(discrim, memory, discrim_optim, args) 
  File "/scratch/nsk367/deepRL/limitation-learning/src/GAIL.py", line 147, in train_discrim
    learner = discrim(states, actions) #pass (s,a) through discriminator
  File "/scratch/nsk367/anaconda3/envs/irl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/scratch/nsk367/deepRL/limitation-learning/src/models/discriminator.py", line 51, in forward
    state = self.state_encoder(state) # idk how good these are 
  File "/scratch/nsk367/anaconda3/envs/irl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/scratch/nsk367/deepRL/limitation-learning/src/models/encoders.py", line 42, in forward
    out, _ = self.memory_cell(x)
  File "/scratch/nsk367/anaconda3/envs/irl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/scratch/nsk367/anaconda3/envs/irl/lib/python3.8/site-packages/torch/nn/modules/rnn.py", line 581, in forward
    result = _VF.lstm(input, hx, self._flat_weights, self.bias, self.num_layers,
RuntimeError: CUDA out of memory. Tried to allocate 14.98 GiB (GPU 0; 15.78 GiB total capacity; 12.24 GiB already allocated; 2.14 GiB free; 12.41 GiB reserved in total by PyTorch)
